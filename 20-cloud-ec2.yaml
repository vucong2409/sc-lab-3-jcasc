jenkins:
  clouds:
    - amazonEC2:
        name: "ec2"
        instanceCapStr: 2
        region: "ap-southeast-1"
        credentialsId: "aws-for-jenkins-master"
        sshKeysCredentialsId: "ssh-for-jenkins-worker"
        templates:
          - description: "Packer Agent for jenkins"
            type: "T3Micro"
            labelString: "packer"
            ami: "${PACKER_WORKER_AMI}"
            securityGroups: "${WORKER_SECURITY_GROUP_ID}"
            deleteRootOnTermination: false
            connectionStrategy: PRIVATE_IP
            subnetId: "${WORKER_SUBNET_ID}"
            remoteFS: "/home/ec2-user"
            remoteAdmin: "ec2-user"
            amiType:
              unixData:
                rootCommandPrefix: "sudo"
            initScript: |
              dd if=/dev/sda1 of=/var/swap.1 bs=1M count=2048
              chmod 600 /var/swap.1
              mkswap /var/swap.1
              swapon /var/swap.1
